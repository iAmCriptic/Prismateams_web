{% extends "base.html" %}

{% block title %}Zu viele Anfragen - {{ app_name or 'Prismateams' }}{% endblock %}

{% block content %}
<div class="auth-container auth-login">
    <div class="auth-card">
        <div class="card">
            <div class="card-body p-4">
                <h1 class="text-center mb-4">
                    {% if portal_logo_filename %}
                    <img src="{{ url_for('settings.portal_logo', filename=portal_logo_filename) }}" alt="{{ app_name or 'Prismateams' }}" height="48" class="mb-2 d-block mx-auto">
                    {% elif app_logo %}
                    <img src="{{ url_for('static', filename=app_logo) }}" alt="{{ app_name or 'Prismateams' }}" height="48" class="mb-2 d-block mx-auto">
                    {% else %}
                    <i class="bi bi-shield-lock text-primary"></i>
                    {% endif %}
                    {{ app_name or 'Prismateams' }}
                </h1>
                
                <!-- Error Icon -->
                <div class="text-center mb-3">
                    <i class="bi bi-hourglass-split text-warning" style="font-size: 3rem;"></i>
                </div>
                
                <!-- Error Title -->
                <h5 class="text-center mb-2 text-warning">Zu viele Anfragen</h5>
                
                <!-- Error Description -->
                <p class="text-center text-muted mb-4">
                    Sie haben zu viele Anmeldeversuche in kurzer Zeit gestellt. 
                    Bitte warten Sie einen Moment, bevor Sie es erneut versuchen.
                </p>
                
                <!-- Info Message -->
                <div class="alert alert-warning mb-4" role="alert">
                    <i class="bi bi-info-circle me-2"></i>
                    <small>Dies ist ein Schutzmechanismus gegen Missbrauch. Bitte warten Sie 1-2 Minuten.</small>
                </div>
                
                <!-- Action Buttons -->
                <div class="d-grid gap-2">
                    {% if current_user.is_authenticated %}
                        <a href="{{ url_for('dashboard.index') }}" class="btn btn-accent">
                            <i class="bi bi-house-door me-2"></i>
                            Zurück zum Dashboard
                        </a>
                    {% else %}
                        <a href="{{ url_for('auth.login') }}" class="btn btn-accent">
                            <i class="bi bi-box-arrow-in-right me-2"></i>
                            Zurück zur Anmeldung
                        </a>
                    {% endif %}
                    
                    <button onclick="location.reload()" class="btn btn-outline-secondary">
                        <i class="bi bi-arrow-clockwise me-2"></i>
                        Erneut versuchen
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
// Farbverlauf-Vorschau für Auth-Seiten
document.addEventListener('DOMContentLoaded', function() {
    const body = document.body;
    const container = document.querySelector('.auth-container');
    const isMobile = window.innerWidth <= 768;
    
    // Auf mobilen Geräten keinen Farbverlauf - einfacher Hintergrund
    if (isMobile) {
        // Kein Farbverlauf auf mobilen Geräten - einfacher Hintergrund
        body.style.background = 'var(--bs-body-bg, #ffffff)' || '#ffffff';
        body.style.backgroundAttachment = 'scroll';
        container.style.background = 'var(--bs-body-bg, #ffffff)' || '#ffffff';
        container.style.backgroundAttachment = 'scroll';
        container.style.backgroundSize = 'auto';
    } else {
        // Vollständiger Farbverlauf für Desktop
        {% if color_gradient %}
        body.style.background = '{{ color_gradient }}';
        body.style.backgroundAttachment = 'fixed';
        body.style.backgroundSize = 'cover';
        container.style.background = '{{ color_gradient }}';
        container.style.backgroundAttachment = 'fixed';
        container.style.backgroundSize = 'cover';
        {% else %}
        // Standard-Farbverlauf anwenden wenn kein Farbverlauf gesetzt ist
        body.style.background = 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)';
        body.style.backgroundAttachment = 'fixed';
        body.style.backgroundSize = 'cover';
        container.style.background = 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)';
        container.style.backgroundAttachment = 'fixed';
        container.style.backgroundSize = 'cover';
        {% endif %}
    }
});
</script>
{% endblock %}
